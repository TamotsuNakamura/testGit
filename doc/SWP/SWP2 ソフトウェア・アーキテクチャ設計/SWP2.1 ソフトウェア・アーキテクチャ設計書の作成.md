# SWP2.1 ソフトウェア・アーキテクチャ設計書の作成

コメントの確認

**ソフトウェア要求仕様書で定義された要求の実現方法（ソフトウェア・アーキテクチャ）を検討し、ソフトウェア・アーキテクチャ設計書としてまとめる。**
WBS-13の変更を行う

## 2.1.1 設計条件の確認

### 入力

[（SW105）](../SWP1%20ソフトウェア要求定義/SWP1.1%20ソフトウェア要求仕様書の作成.md)ソフトウェア要求仕様書
（SY205）システム・アーキテクチャ設計書

### 概要

ソフトウェア・アーキテクチャを設計するにあたっての要求・条件を確認する。

### 出力

（設計条件確認メモ）

### 参照情報

各ハードウェア仕様書

### 実施内容

---

**ソフトウェアの設計を進めるにあたり、[ソフトウェア要求仕様書（SW105）](../SWP1%20ソフトウェア要求定義/SWP1.1%20ソフトウェア要求仕様書の作成.pdf)に記述された機能要求、非機能要求や前提とする制約事項などを確認しておく。**

1. ソフトウェア機能要求を確認する
   * ソフトウェア要求仕様書に記述されたソフトウェア機能要求の内容をもとに、どのような機能をソフトウェアとして実現することが求められているか確認する。

1. ソフトウェア非機能要求を確認する
   * ソフトウェア要求仕様書に記載されたソフトウェア非機能要求を確認する。

1. 制約条件を確認する
   * ソフトウェア要求仕様書に記載されたソフトウェア機能を再考し、それらの機能を実現するためのソフトウェア・アーキテクチャの実現という視点から、下記のような制約条件も併せて確認する。
   * ソフトウェア作成条件（使用OS、言語など）
   * ハードウェア条件（割込み方式など）
   * 性能条件、稼働環境など
   * 安全性要求

### 注意すべき事項

---

* 特に下記に示す事項については重点的に確認する。
  * 性能要求の具体的条件、異常/例外の動作仕様
  * メモリ量、外部記憶媒体の種類と容量
  * ハードウェア機器/素子の種類・仕様・処理能力
  * 既存ソフトウェア（OS等を含む）利用時の調査
* システムに求められるセキュリティなどの面についても検討しておく。
* システムに求められる安全に関する要求（安全度のレベルとそれを実現する機能など）を確認する。
* ソフトウェア要求仕様書の漏れや未決定事項などがないかを確認する。  

## 2.1.2 ソフトウェア構成の設計

### 入力

[（SW105）](../SWP1%20ソフトウェア要求定義/SWP1.1%20ソフトウェア要求仕様書の作成.pdf)ソフトウェア要求仕様書
（SY205）システム・アーキテクチャ設計書

### 概要

ソフトウェアの構成および機能ユニットの機能を設計する。

### 出力

（SW201）ソフトウェア構成設計書
（SW202）機能ユニット設計書

<a id = "SW201"></a>
<a id = "SW202"></a>

### 参照情報

各ハードウェア仕様書

### 実施内容

---

**ソフトウェア要求仕様を実現するために必要となる、ソフトウェアとしての個別要素（機能ユニット）を検討し、整理する。**

1. 機能ユニットを抽出する。
   * ソフトウェアとして実現する機能を明確にし、共通する処理などを局所化、共通化を図りながら機能ユニットを抽出する。また、機能ユニットの抽出の際には以下に示すようなソフトウェアの非機能要求にも十分配慮する。
   * 信頼性（リカバリ/データ保証など）
   * 保守性（不具合追跡など）

1. 機能ユニットを詳細化する。
   * 個々の機能ユニットは、ソフトウェア詳細設計ができるレベル（粒度）まで構成を詳細化する。

### 注意すべき事項

---

* ソフトウェア構成の設計では以下に注意する
  * 保守性、開発効率、テスト効率性、信頼性、拡張性、安全性を考慮する。
  * 変更/修正のコスト、品質確保を考慮した機能の局所化/カプセル化
  * 開発効率/メモリ効率を考慮した部品化/共通化
  * デバッグ/テスト/保守のための動作ログ/取り出し機構具備
  * 出荷後のソフトウェア変更機構の具備
  * フェイルセーフ機構の具備
* 設計の進め方
  * ソフトウェア・アーキテクチャ設計では、各ソフトウェア詳細設計担当者に割り振れるレベルまで機能ユニットを詳細化する。
  * 構成設計は、振る舞い、インタフェース設計と連携して実施される。
* その他の考慮点
  * 機能ユニットの位置/関係が分かる構成図（機能ユニット関連図）を作成する。
  * 製品シリーズ化などを考慮し、ソフトウェアのコアとなる機能ユニットは明確に区分しておく。

## 2.1.3 ソフトウェア全体の振る舞いの設計

### 入力

[（SW105）](../SWP1%20ソフトウェア要求定義/SWP1.1%20ソフトウェア要求仕様書の作成.pdf)ソフトウェア要求仕様書
（SY205）システム・アーキテクチャ設計書

### 概要

ソフトウェア全体の振る舞いを設計する。

### 出力

（SW203）ソフトウェア動作設計書
<a id = "SW203"></a>

### 参照情報

各ハードウェア仕様書

### 実施内容

---

**ハードウェアを含めたシステムがどのような動的振る舞いをするのかを考え、整理する。**

  * システムの振る舞いのなかで、ソフトウェアが担う動作を明確にする。
  * ソフトウェア動作の前提となるコンテキストを明確にし、ソフトウェア要求仕様に記載された動作シナリオや動作シーケンスを検討する。特に具体的な動作に伴うシステムとしての動作シーケンス上の操作性も考慮する。特に組込みソフトウェアでは下記の事項を考慮する。
  * 並行処理動作：ハード割込み動作、タスク・プライオリティと並行処理/タスク遷移など
  * 異常・例外発生：過負荷、ハード障害など
  * データ処理の流れ：入力から出力までのデータ処理過程

### 注意すべき事項

---

* 動作/制御の表現方法は、ビジュアルなものを併用しわかりやすくする
  * 振る舞いの整理については状態遷移モデル他の手法を利用して整理する。 
* 組込みソフトウェアの振る舞い設計では下記のような点に留意する
  * 性能考慮時：並行動作とタスクプライオリティ、SRAM/キャッシュへの割り当て
  * リアルタイム性：割込み制御とハード割込みレベル設定
  * 多重処理：排他制御（資源の確保/開放/競合）
  * 異常/例外処理:Dos攻撃対応、リカバリ動作、ノイズによるデータ化け、MPU誤動作、チャタリング
  * メモリ配置の考慮：常駐/非常駐、ROM/RAM
  * マルチ・プロセッサ構成時：負荷分散、資源排他制御
  * 各機能ユニット内部および機能ユニット間の状態定義、状態遷移を明確化
  * 各機能ユニットの時間制約

## 2.1.4 インターフェースの設計

### 入力

[（SW105）](../SWP1%20ソフトウェア要求定義/SWP1.1%20ソフトウェア要求仕様書の作成.pdf)ソフトウェア要求仕様書
（SY205）システム・アーキテクチャ設計書

### 概要

機能ユニット間のインターフェースを設計する。

### 出力

（SW204）ソフトウェア・インターフェース設計書
<a id = "SW204"></a>
### 参照情報

各ハードウェア仕様書

### 実施内容

---

**ソフトウェアを構成する機能ユニット間のインターフェースを設計する。**

1. メモリーレイアウトを設計する。  
   * メモリ全体のレイアウトを設計する。

1. メモリ空間・領域を詳細化する。
   * ソフトウェアとして利用する各領域の詳細を決める。

     * 領域全体の名称/名前/サイズを決める。

     * 領域内フィールドの名称/位置/形式/サイズ/意味/初期値/アクセス元など

1. 機能ユニット間のインターフェースを設計する。
   * 呼び出し手順、パラメータ、復帰情報等を設計する。

1. 共通情報を一元化、論理値化する。
   * 変更に対して修正負荷の高い情報は、一元化し、かつ論理値化しておく
     * テーブル・オフセット
     * 共通定数など

### 注意すべき事項

---

* インターフェース設計の考慮点
  * 異常/例外コード、メッセージを早めに抽出し体系化し、一覧表として整理する。

  * 排他的処理が必要な共通データについては更新/参照元を明確化する。

  * 共通リソースについては、確保/開放タイミングを明らかにする。

  * ビット構成等では拡張性を考慮する。

## 2.1.5 性能/メモリ使用量の見積もり

### 入力

（SY205）システム・アーキテクチャ設計書
[（SW201）](#SW201)ソフトウェア構成設計書
[（SW203）](#SW203)ソフトウェア動作設計書
[（SW204）](#SW204)ソフトウェア・インタフェース設計書

### 概要

性能条件、メモリ量条件を検討し、性能、メモリ使用量を見積もる。

### 出力

（性能試算資料）
（メモリ使用試算資料）
<a id = "seinou"></a>
<a id = "memory"></a>

### 実施内容

---

1. 性能を見積もる。
   * 正確で、最悪条件での性能を見積もるようにする。

      * クリティカルな要素は実測に基づくデータを参考にする
      * 過負荷時のシステム全体のスループットを算出する

1. メモリ使用量を見積もる。
   * 過負荷時のスタックなど漏れのないように見積もる。

      * プログラム・コード部とテーブル、バッファ等のデータ部の両者
      * 動的な観点での見積もり
      * ROM、RAM（SRAMを含む）、キャッシュなどすべて
   * 必要により、ハードディスクなど他のハードリソースについても見積もる。

### 注意すべき事項

---

* 性能見積もりの考慮点
  * ハードウェア特性（入出力機器の処理性能/応答性能、メモリ・ウェイトなど）
  * 立ち上がり性能、最悪のケースを考慮
  * OS処理時間の考慮など
ソフトウェアで実現する個々の処理の時間や応答性能は、ユーザの操作性などにも影響を与えるため実現方法を含め慎重に検討する。
* メモリ量見積もりの考慮点
  * 処理多重度およびネスト数によるスタック量、OS領域（タスク制御テーブルなど）
  * コード部の見積もりは、規模見積もりから換算する。

## 2.1.6 ソフトウェア・アーキテクチャ設計書の作成

### 入力

[（SW201）](#SW201)ソフトウェア構成設計書
[（SW202）](#SW202)機能ユニット設計書
[（SW203）](#SW203)ソフトウェア動作設計書
[（SW204）](#SW204)ソフトウェア・インタフェース設計書
[（性能試算資料）](#seinou)
[（メモリ使用試算資料）](#memory)

### 概要

ソフトウェア・アーキテクチャ設計の事項を整理し、ソフトウェア・アーキテクチャ設計書としてまとめる。

### 出力

（SW205）ソフトウェア・アーキテクチャ設計書

### 実施内容

---

**（SW201）~（SW204）の成果を取りまとめてソフトウェア・アーキテクチャ設計書（SW205）を作成する。**
  * ソフトウェア・アーキテクチャ設計の過程で出力された資料を整理・体系化して文書化する。
  * 内部確認、共同レビュー等での指摘事項が適切に反映されていることも確認する。

### 注意すべき事項

---

* 参考資料等について
  * 設計の妥当性を示す資料（性能見積もり、資源使用量見積もり、制御方式等） 、およびどのような観点で設計したか（設計方針）を別資料で残すと、仕様変更、トラブル対処時に有効である。
  * 変更/追加内容が確認できるような版数管理および改版リストの添付が望ましい。
* 文書化での留意点
  * 機能ユニット名、タスク/プロセス名を体系的に整理しておく。
  * 変更履歴を添付し、変更箇所を明示する。
  * 作成文書に関しての責任所在を明示する。
  * 作成文書は構成管理および変更管理にて確実に管理する。
